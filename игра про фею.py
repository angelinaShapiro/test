import random
import time

def slow_print(text, delay=0.03):
  """Печатает текст посимвольно с небольшой задержкой для эффекта печатающей машинки."""
  for char in text:
    print(char, end='', flush=True)
    time.sleep(delay)
  print()

def choose_path(options):
  """Предлагает игроку выбрать путь из списка вариантов."""
  slow_print("Что ты будешь делать?")
  for i, option in enumerate(options):
    slow_print(f"{i+1}. {option}")

  while True:
    try:
      choice = int(input("> "))
      if 1 <= choice <= len(options):
        return choice - 1
      else:
        slow_print("Пожалуйста, выберите вариант из списка.")
    except ValueError:
      slow_print("Пожалуйста, введите число.")

def fairy_adventure():
  """Основная функция игры."""
  fairy_name = input("Как зовут твою фею? ")
  slow_print(f"Добро пожаловать в Волшебный Лес, {fairy_name}!")

  # Начало истории
  slow_print(f"Однажды утром, {fairy_name}, ты проснулась от тревожных новостей.")
  slow_print("Королева эльфов вызвала тебя на срочное задание!")

  # Первая развилка
  slow_print("Королева эльфов говорит, что злой гоблин украл Лунный Камень, источник магии Волшебного Леса.")
  slow_print("Ты должна вернуть его! У тебя есть два пути:")
  path1 = "Пойти через Тёмный Лес, полный опасностей."
  path2 = "Попросить помощи у мудрой Совы и полететь над Горами Тумана."
  choice = choose_path([path1, path2])

  if choice == 0:
    # Путь через Темный Лес
    slow_print("Ты вступаешь в мрачный Тёмный Лес. Деревья кажутся зловещими, и каждый шорох пугает.")

    # Встреча с пауком
    slow_print("Внезапно из тени появляется огромный паук!")
    option1 = "Сразиться с пауком, используя свою магию."
    option2 = "Попытаться убежать, спрятавшись в корнях деревьев."
    choice = choose_path([option1, option2])

    if choice == 0:
      # Сражение с пауком (удача или неудача)
      if random.random() > 0.5:
        slow_print("Ты храбро сражаешься с пауком и побеждаешь его! Он убегает, оставив тебе немного блестящей паутины.")
        slow_print("Ты можешь использовать эту паутину позже.")
        inventory = ["блестящая паутина"]  # Добавляем паутину в инвентарь
      else:
        slow_print("Паук оказался слишком сильным. Ты с трудом убегаешь, потеряв немного пыльцы крыльев.")
        inventory = [] # Инвентарь пуст
      # продолжение приключения в темном лесу
      slow_print("Ты продолжаешь свой путь по темному лесу")
      slow_print("Перед тобой развилка, нужно пересечь реку или обойти через болото")
      option1 = "Перейти реку вброд"
      option2 = "Обойти через болото"
      choice = choose_path([option1, option2])
      if choice == 0:
        slow_print("Ты пытаешься перейти реку вброд, но течение слишком сильное. Тебя сносит вниз по течению.")
        slow_print("К счастью, ты выбираешься на берег, но потеряла много времени.")
      else:
        slow_print("Ты решаешь обойти реку через болото. Это медленный и грязный путь.")
        slow_print("Тебя кусают комары и мошки. Твоя одежда вся в грязи и тине.")

    else:
      # Побег от паука
      slow_print("Ты прячешься в корнях деревьев, и паук, не заметив тебя, уходит.")
      inventory = []  # Инвентарь пуст

    # Встреча с гоблином (финал Тёмного Леса)
    slow_print("Ты, наконец, выбираешься из Тёмного Леса и видишь гоблина, танцующего вокруг костра!")
    option1 = "Подкрасться к гоблину и украсть Лунный Камень."
    option2 = "Напасть на гоблина с магией!"
    choice = choose_path([option1, option2])

    if choice == 0:
      # Подкрасться
      if "блестящая паутина" in inventory:
        slow_print("Ты бесшумно подкрадываешься к гоблину, используя блестящую паутину, чтобы отвлечь его.")
        slow_print("Ты хватаешь Лунный Камень и убегаешь! Победа!")
      else:
        slow_print("Гоблин замечает тебя! Он бросается в атаку! Ты проигрываешь...")
    else:
      # Напасть
      slow_print("Ты обрушиваешь на гоблина всю свою магию! Он кричит и роняет Лунный Камень. Ты хватаешь его и убегаешь! Победа!")

  else:
    # Путь через Горы Тумана
    slow_print("Мудрая Сова соглашается помочь тебе и несет тебя над Горами Тумана.")
    slow_print("Вы летите высоко над облаками, но вдруг...")
    slow_print("На вас нападает стая злых гарпий!")

    option1 = "Попробовать отбиться от гарпий с помощью магии."
    option2 = "Спрятаться в облаках и надеяться, что гарпии улетят."
    choice = choose_path([option1, option2])

    if choice == 0:
      # Отбиться от гарпий
      slow_print("Ты сражаешься с гарпиями, используя всю свою магию.  Это трудный бой, но ты побеждаешь!")
      slow_print("Гарпии улетают прочь. Вы продолжаете полёт.")
    else:
      # Спрятаться в облаках
      slow_print("Вы ныряете в облака. Гарпии теряют вас из виду и улетают.")
      slow_print("Однако вы немного заблудились в облаках...")

    # Встреча с гоблином (финал Гор Тумана)
    slow_print("Вы, наконец, приземляетесь и видите гоблина, устроившего лагерь у подножия горы.")
    slow_print("Он спит, обнимая Лунный Камень.")

    option1 = "Тихо подкрасться и забрать Лунный Камень, пока гоблин спит."
    option2 = "Разбудить гоблина и потребовать вернуть Лунный Камень!"
    choice = choose_path([option1, option2])

    if choice == 0:
      # Тихо подкрасться
      slow_print("Ты крадешься к гоблину, стараясь не шуметь. Ты тихо забираешь Лунный Камень и убегаешь! Победа!")
    else:
      # Разбудить гоблина
      slow_print("Ты будно гоблина. Он просыпается злым и начинает кричать!")
      slow_print("Ты угрожаешь ему своей магией, и он, испугавшись, отдает тебе Лунный Камень. Победа!")

  # Конец игры
  slow_print("Ты возвращаешь Лунный Камень королеве эльфов. Волшебный Лес спасён!")
  slow_print(f"Спасибо за игру, {fairy_name}!")

# Запуск игры
fairy_adventure()